import React, { useState } from 'react';
import PhotoUploader from './PhotoUploader';
import TryOnViewer from './TryOnViewer';
import ChatBox from './ChatBox';

function App() {
  const [userPhoto, setUserPhoto] = useState(null);
  const [garmentPhoto, setGarmentPhoto] = useState(null);
  const [tryOnResult, setTryOnResult] = useState(null);

  const handleTryOn = async () => {
    if (!userPhoto || !garmentPhoto) {
      alert('Please upload both your photo and garment photo!');
      return;
    }
    const formData = new FormData();
    formData.append('user_photo', userPhoto);
    formData.append('garment_photo', garmentPhoto);
    const res = await fetch('https://fashion-ai-assistant-2-qa47.onrender.com/try-on/', {
      method: 'POST',
      body: formData
    });
    const data = await res.json();
    setTryOnResult(data.result_image);
  };

  return (
    <div style={{ maxWidth: '600px', margin: 'auto', padding: '1rem' }}>
      <h1 style={{ textAlign: 'center' }}>AI Fashion Assistant</h1>
      <PhotoUploader label="Upload Your Photo" onUpload={setUserPhoto} />
      <PhotoUploader label="Upload Garment Photo" onUpload={setGarmentPhoto} />
      <button onClick={handleTryOn}>Try On Clothes</button>
      <TryOnViewer tryOnResult={tryOnResult} />
      <ChatBox />
    </div>
  );
}

export default App;

